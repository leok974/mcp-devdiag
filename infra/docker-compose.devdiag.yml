version: "3.9"
services:
  devdiag-http:
    image: ghcr.io/leok974/mcp-devdiag/devdiag-http:latest
    restart: unless-stopped
    networks: [infra_net]
    ports:
      - "127.0.0.1:8080:8080"   # local-only; Cloudflare Tunnel will front it
    env_file:
      - .env.devdiag.infra
    healthcheck:
      test: ["CMD", "curl", "-fsS", "http://127.0.0.1:8080/ready"]
      interval: 20s
      timeout: 5s
      retries: 5
      start_period: 20s

networks:
  infra_net:
    external: true
